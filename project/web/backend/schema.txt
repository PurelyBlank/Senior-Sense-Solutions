create table Caretaker(
user_id SERIAL PRIMARY KEY,
first_name VARCHAR(100) NOT NULL,
last_name VARCHAR(100) NOT NULL,
address TEXT, 
phone_number VARCHAR(15),
created_at TIMESTAMPTZ DEFAULT NOW(),
email VARCHAR(100) NOT NULL UNIQUE,
user_password VARCHAR(100) NOT NULL
);
create table wearable(
wearable_id SERIAL PRIMARY KEY,
firmware_version VARCHAR(20) NOT NULL
);
CREATE TYPE gender_type AS ENUM ('Male', 'Female');
create table patients(
patient_id SERIAL PRIMARY KEY,
caretaker_id INT, 
wearable_id INT NOT NULL UNIQUE,
first_name VARCHAR(100) NOT NULL,
last_name VARCHAR(100) NOT NULL,
phone_number VARCHAR(15),
address TEXT, 
gender gender_type,
age INT,
weight INT,
CONSTRAINT fk_caretaker FOREIGN KEY (caretaker_id) REFERENCES caretaker(user_id),
CONSTRAINT fk_wearable FOREIGN KEY (wearable_id) REFERENCES wearable(wearable_id)
);
create table wearable_data(
patient_id INT NOT NULL,
wearable_id INT NOT NULL,
timestamp TIMESTAMPTZ,
battery_level double precision,
heart_rate double precision,
blood_oxygen double precision,
longitude double precision,
latitude double precision,
CONSTRAINT fk_patient FOREIGN KEY (patient_id) REFERENCES patients(patient_id),
CONSTRAINT fk_wearable FOREIGN KEY (wearable_id) REFERENCES wearable(wearable_id)
);
CREATE EXTENSION IF NOT EXISTS timescaledb;
SELECT create_hypertable('wearable_data', 'timestamp');
create table alerts(
alert_id SERIAL PRIMARY KEY,
patient_id INT NOT NULL,
wearable_id INT NOT NULL,
timestamp TIMESTAMPTZ,
message TEXT,
CONSTRAINT fk_patient FOREIGN KEY (patient_id) REFERENCES patients(patient_id),
CONSTRAINT fk_wearable FOREIGN KEY (wearable_id) REFERENCES wearable(wearable_id)
);
create table calls(
call_id SERIAL PRIMARY KEY,
patient_id INT NOT NULL,
wearable_id INT NOT NULL,
timestamp TIMESTAMPTZ,
caller_id VARCHAR(15),
receiver_id VARCHAR(15),
CONSTRAINT fk_patient FOREIGN KEY (patient_id) REFERENCES patients(patient_id),
CONSTRAINT fk_wearable FOREIGN KEY (wearable_id) REFERENCES wearable(wearable_id)
);
create table reminders(
reminder_id SERIAL PRIMARY KEY,
patient_id INT NOT NULL,
wearable_id INT NOT NULL,
created_at TIMESTAMPTZ DEFAULT NOW(),
message TEXT,
complied BOOLEAN NOT NULL DEFAULT FALSE,
CONSTRAINT fk_patient FOREIGN KEY (patient_id) REFERENCES patients(patient_id),
CONSTRAINT fk_wearable FOREIGN KEY (wearable_id) REFERENCES wearable(wearable_id)
);